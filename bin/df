#!/bin/bash

cd ~/dotfiles
git pull origin master
find bin/ -type f -exec chmod 770

function install_file {
	cd

	if [ -L "$1" ]; then
		exit
	fi

	cd ~/dotfiles/backups
	rm -rf "$1" >/dev/null 2>&1
	
	cd
	mv "$1" ~/dotfiles/backups >/dev/null 2>&1
	
	cd ~/dotfiles/files
	filepath=`readlink -f "$1"`

	cd
	ln -s "$filepath"
	
	echo "Linked $1"	
}
export -f install_file

cd ~/dotfiles/files
find . -maxdepth 1 ! -name . -exec bash -c 'install_file "$0"' {} \;
